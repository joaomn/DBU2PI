
-- INSERTS DELFOS

INSERT INTO clientes (data_nascimento, email, nome, password, telefone)
VALUES
    ('1990-01-15', 'joao.silva@example.com', 'João Silva', 'senha123', '1111111111'),
    ('1985-05-22', 'maria.santos@example.com', 'Maria Santos', 'senha456', '2222222222'),
    ('1992-09-10', 'pedro.oliveira@example.com', 'Pedro Oliveira', 'senha789', '3333333333'),
    ('1988-03-18', 'ana.pereira@example.com', 'Ana Pereira', 'senha321', '4444444444'),
    ('1993-07-27', 'luiza.costa@example.com', 'Luiza Costa', 'senha654', '5555555555'),
    ('1991-12-03', 'rafael.rocha@example.com', 'Rafael Rocha', 'senha987', '6666666666'),
    ('1996-04-09', 'mariana.almeida@example.com', 'Mariana Almeida', 'senha159', '7777777777'),
    ('1987-08-14', 'fernando.santos@example.com', 'Fernando Santos', 'senha753', '8888888888'),
    ('1994-02-21', 'carolina.lima@example.com', 'Carolina Lima', 'senha246', '9999999999'),
    ('1999-06-07', 'gabriel.ferreira@example.com', 'Gabriel Ferreira', 'senha802', '1010101010'),
    ('1992-11-30', 'amanda.sousa@example.com', 'Amanda Sousa', 'senha506', '1111111111'),
    ('1986-05-04', 'rodrigo.castro@example.com', 'Rodrigo Castro', 'senha719', '1212121212'),
    ('1993-09-19', 'larissa.ribeiro@example.com', 'Larissa Ribeiro', 'senha423', '1313131313'),
    ('1989-01-23', 'bruno.barbosa@example.com', 'Bruno Barbosa', 'senha736', '1414141414'),
    ('1997-07-17', 'isabela.gomes@example.com', 'Isabela Gomes', 'senha149', '1515151515'),
    ('1991-03-11', 'mateus.oliveira@example.com', 'Mateus Oliveira', 'senha862', '1616161616'),
    ('1988-10-26', 'camila.rodrigues@example.com', 'Camila Rodrigues', 'senha275', '1717171717'),
    ('1995-04-02', 'guilherme.carvalho@example.com', 'Guilherme Carvalho', 'senha588', '1818181818'),
    ('1994-11-25', 'juliana.martins@example.com', 'Juliana Martins', 'senha991', '1919191919'),
    ('1993-08-08', 'lucas.souza@example.com', 'Lucas Souza', 'senha204', '2020202020'),
    ('1990-02-13', 'vitoria.santos@example.com', 'Vitória Santos', 'senha517', '2121212121'),
    ('1987-06-28', 'henrique.ferreira@example.com', 'Henrique Ferreira', 'senha820', '2222222222'),
    ('1996-12-12', 'laura.oliveira@example.com', 'Laura Oliveira', 'senha133', '2323232323'),
    ('1992-07-06', 'rafaela.rodrigues@example.com', 'Rafaela Rodrigues', 'senha446', '2424242424'),
    ('1998-03-21', 'pedro.pereira@example.com', 'Pedro Pereira', 'senha759', '2525252525'),
    ('1985-09-04', 'julia.alves@example.com', 'Júlia Alves', 'senha162', '2626262626'),
    ('1997-11-18', 'gustavo.melo@example.com', 'Gustavo Melo', 'senha575', '2727272727'),
    ('1993-05-02', 'luciana.silveira@example.com', 'Luciana Silveira', 'senha888', '2828282828'),
    ('1991-12-17', 'eduardo.ferreira@example.com', 'Eduardo Ferreira', 'senha191', '2929292929'),
    ('1989-08-31', 'beatriz.cavalcanti@example.com', 'Beatriz Cavalcanti', 'senha494', '3030303030'),
    ('1995-02-14', 'roberto.santana@example.com', 'Roberto Santana', 'senha797', '3131313131'),
    ('1992-06-29', 'ana.lima@example.com', 'Ana Lima', 'senha110', '3232323232'),
    ('1987-10-13', 'marcio.albuquerque@example.com', 'Márcio Albuquerque', 'senha413', '3333333333'),
    ('1996-04-27', 'alice.vieira@example.com', 'Alice Vieira', 'senha716', '3434343434'),
    ('1990-11-11', 'thiago.mendonca@example.com', 'Thiago Mendonça', 'senha219', '3535353535'),
    ('1988-07-25', 'gabriela.carvalho@example.com', 'Gabriela Carvalho', 'senha522', '3636363636'),
    ('1994-01-09', 'rodrigo.sousa@example.com', 'Rodrigo Sousa', 'senha925', '3737373737'),
    ('1993-09-23', 'fernanda.oliveira@example.com', 'Fernanda Oliveira', 'senha228', '3838383838'),
    ('1989-12-06', 'marcos.andrade@example.com', 'Marcos Andrade', 'senha531', '3939393939');
    
    
    INSERT INTO empresa (cnpj_cpf, email, password, razao_social, nome_responssavel, telefone)
VALUES
    ('12345678901234', 'auto_lava_jato_excelencia@example.com', 'senha123', 'Auto Lava Jato Excelência', 'Lucas Santos', '1111111111'),
    ('98765432109876', 'petshop_amigao@example.com', 'senha456', 'PetShop Amigão', 'Isabela Oliveira', '2222222222'),
    ('56789012345678', 'jardins_verdes_paisagismo@example.com', 'senha789', 'Jardins Verdes Paisagismo', 'Ricardo Almeida', '3333333333'),
    ('43210987654321', 'mecanica_veloz@example.com', 'senha987', 'Mecânica Veloz', 'Fernando Silva', '4444444444'),
    ('98765432101234', 'tecnotech@example.com', 'senha654', 'TecnoTech Soluções Tecnológicas', 'Carolina Lima', '5555555555'),
    ('56789012345678', 'delicias_gourmet@example.com', 'senha321', 'Delícias Gourmet Buffet', 'Mariana Costa', '6666666666'),
    ('43210987654321', 'clinica_animal_care@example.com', 'senha159', 'Clínica Animal Care', 'Rafaela Mendes', '7777777777'),
    ('98765432101234', 'moda_fashion@example.com', 'senha753', 'Moda Fashion Boutique', 'Guilherme Santos', '8888888888'),
    ('56789012345678', 'arte_madeira@example.com', 'senha246', 'Arte em Madeira Marcenaria', 'Gustavo Barbosa', '9999999999'),
    ('43210987654321', 'estetica_bella_vita@example.com', 'senha802', 'Estética Bella Vita', 'Fernanda Almeida', '1010101010'),
    ('98765432101234', 'clinica_odontologica@example.com', 'senha506', 'Clínica Odontológica Sorrir+', 'Camila Rodrigues', '1111111111'),
    ('56789012345678', 'doces_momentos@example.com', 'senha719', 'Doces Momentos Confeitaria', 'Pedro Castro', '1212121212'),
    ('43210987654321', 'agrocampo@example.com', 'senha423', 'AgroCampo Produtos Agropecuários', 'Larissa Ribeiro', '1313131313'),
    ('98765432101234', 'consultoria_estrategica@example.com', 'senha736', 'Consultoria Estratégica Empresarial', 'Bruno Barbosa', '1414141414'),
    ('56789012345678', 'moda_kids@example.com', 'senha149', 'Moda Kids', 'Isabela Gomes', '1515151515'),
    ('43210987654321', 'auto_eletrica_performance@example.com', 'senha862', 'Auto Elétrica Performance', 'Mateus Oliveira', '1616161616'),
    ('98765432101234', 'baba_carinhosa@example.com', 'senha275', 'Babá Carinhosa', 'Camila Santos', '1717171717'),
    ('56789012345678', 'turismo_aventura@example.com', 'senha683', 'Turismo Aventura', 'Thiago Costa', '1818181818'),
    ('43210987654321', 'consultoria_financeira@example.com', 'senha596', 'Consultoria Financeira Top Finanças', 'Amanda Rodrigues', '1919191919'),
    ('98765432101234', 'auto_peças_motor@example.com', 'senha910', 'Auto Peças Motor', 'Gustavo Almeida', '2020202020'),
    ('56789012345678', 'pinturas_criativas@example.com', 'senha228', 'Pinturas Criativas', 'Fernanda Silva', '2121212121'),
    ('43210987654321', 'confeitaria_sabor@example.com', 'senha541', 'Confeitaria Sabor e Arte', 'Ricardo Mendes', '2222222222'),
    ('98765432101234', 'reparos_residenciais@example.com', 'senha853', 'Reparos Residenciais 24 Horas', 'Juliana Costa', '2323232323'),
    ('56789012345678', 'serviços_limpeza@example.com', 'senha165', 'Serviços de Limpeza e Conservação', 'Mariana Sousa', '2424242424'),
    ('43210987654321', 'pet_virtual@example.com', 'senha478', 'Pet Virtual - Pet Shop Online', 'Pedro Carvalho', '2525252525'),
    ('98765432101234', 'publicidade_criativa@example.com', 'senha791', 'Publicidade Criativa', 'Vanessa Almeida', '2626262626'),
    ('56789012345678', 'contabilidade_confiança@example.com', 'senha102', 'Contabilidade Confiança', 'Eduardo Rodrigues', '2727272727'),
    ('43210987654321', 'restaurante_saboroso@example.com', 'senha413', 'Restaurante Saboroso', 'Laura Nunes', '2828282828'),
    ('98765432101234', 'tecnologia_inovadora@example.com', 'senha725', 'Tecnologia Inovadora', 'Rafaela Lima', '2929292929'),
    ('56789012345678', 'eletronicos_top@example.com', 'senha137', 'Eletrônicos Top', 'Renato Alves', '3030303030'),
    ('43210987654321', 'advocacia_confiança@example.com', 'senha549', 'Advocacia Confiança', 'Carla Ferreira', '3131313131'),
    ('98765432101234', 'engenharia_construtiva@example.com', 'senha952', 'Engenharia Construtiva', 'Fernando Rocha', '3232323232'),
    ('56789012345678', 'academia_vida_saudavel@example.com', 'senha264', 'Academia Vida Saudável', 'Luana Souza', '3333333333'),
    ('43210987654321', 'transporte_agil@example.com', 'senha576', 'Transporte Ágil', 'Maurício Oliveira', '3434343434'),
    ('98765432101234', 'recursos_humanos@example.com', 'senha890', 'Recursos Humanos', 'Tatiana Santos', '3535353535'),
    ('56789012345678', 'construtora_mega@example.com', 'senha107', 'Construtora Mega', 'Diego Barbosa', '3636363636'),
    ('43210987654321', 'decoração_estilo@example.com', 'senha421', 'Decoração Estilo', 'Larissa Silva', '3737373737'),
    ('98765432101234', 'moda_masculina@example.com', 'senha734', 'Moda Masculina', 'Gustavo Oliveira', '3838383838'),
    ('56789012345678', 'pet_shop_fofura@example.com', 'senha149', 'Pet Shop Fofura', 'Amanda Costa', '3939393939'),
    ('43210987654321', 'cafe_cultura@example.com', 'senha452', 'Café Cultura', 'Ricardo Barbosa', '4040404040');
    
    
    
    INSERT INTO anuncio (avaliacao, data_postagem, email, telefone, texto, tipo, nome_anuncio, valor, empresa_id)
VALUES
    (4, '2023-07-05', 'jardinagem1@example.com', '1111111111', 'Anúncio de serviços de jardinagem', 'Serviços', 'Jardinagem profissional', '150', 1),
    (3, '2023-07-05', 'moveis_usados2@example.com', '2222222222', 'Anúncio de venda de móveis usados', 'Venda', 'Móveis seminovos', '200', 2),
    (5, '2023-07-06', 'aluguel_imoveis3@example.com', '3333333333', 'Anúncio de aluguel de imóveis', 'Aluguel', 'Apartamentos para alugar', '1000', 3),
    (4, '2023-07-06', 'personal_trainer4@example.com', '4444444444', 'Anúncio de serviços de personal trainer', 'Serviços', 'Personal trainer qualificado', '80', 4),
    (3, '2023-07-07', 'venda_joias5@example.com', '5555555555', 'Anúncio de venda de joias', 'Venda', 'Joias de qualidade', '500', 5),
    (5, '2023-07-07', 'aulas_fotografia6@example.com', '6666666666', 'Anúncio de aulas de fotografia', 'Serviços', 'Aulas de fotografia', '70', 6),
    (4, '2023-07-08', 'aluguel_equipamentos7@example.com', '7777777777', 'Anúncio de aluguel de equipamentos para eventos', 'Aluguel', 'Equipamentos para eventos', '200', 7),
    (3, '2023-07-08', 'manutencao_residencial8@example.com', '8888888888', 'Anúncio de serviços de manutenção residencial', 'Serviços', 'Manutenção de casas', '300', 8),
    (5, '2023-07-09', 'venda_roupas9@example.com', '9999999999', 'Anúncio de venda de roupas femininas', 'Venda', 'Roupas para mulheres', '50', 9),
    (4, '2023-07-09', 'design_interiores10@example.com', '1010101010', 'Anúncio de serviços de design de interiores', 'Serviços', 'Design de interiores personalizado', '500', 10),    
    (4, '2023-07-05', 'jardinagem41@example.com', '1111111111', 'Anúncio de serviços de jardinagem', 'Serviços', 'Jardinagem profissional', '150', 31),
    (3, '2023-07-05', 'moveis_usados42@example.com', '2222222222', 'Anúncio de venda de móveis usados', 'Venda', 'Móveis seminovos', '200', 12),
    (5, '2023-07-06', 'aluguel_imoveis43@example.com', '3333333333', 'Anúncio de aluguel de imóveis', 'Aluguel', 'Apartamentos para alugar', '1000', 33),
    (4, '2023-07-06', 'personal_trainer44@example.com', '4444444444', 'Anúncio de serviços de personal trainer', 'Serviços', 'Personal trainer qualificado', '80', 14),
    (3, '2023-07-07', 'venda_joias45@example.com', '5555555555', 'Anúncio de venda de joias', 'Venda', 'Joias de qualidade', '500', 35),
    (5, '2023-07-07', 'aulas_fotografia46@example.com', '6666666666', 'Anúncio de aulas de fotografia', 'Serviços', 'Aulas de fotografia', '70', 36),
    (4, '2023-07-08', 'aluguel_equipamentos47@example.com', '7777777777', 'Anúncio de aluguel de equipamentos para eventos', 'Aluguel', 'Equipamentos para eventos', '200', 27),
    (3, '2023-07-08', 'manutencao_residencial48@example.com', '8888888888', 'Anúncio de serviços de manutenção residencial', 'Serviços', 'Manutenção de casas', '300', 18),
    (5, '2023-07-09', 'venda_roupas49@example.com', '9999999999', 'Anúncio de venda de roupas femininas', 'Venda', 'Roupas para mulheres', '50', 29),
    (4, '2023-07-09', 'design_interiores50@example.com', '1010101010', 'Anúncio de serviços de design de interiores', 'Serviços', 'Design de interiores personalizado', '500', 40),
     (3, '2023-07-10', 'reformas_residenciais51@example.com', '1111111111', 'Anúncio de serviços de reformas residenciais', 'Serviços', 'Reformas de casas e apartamentos', '1000', 11),
    (4, '2023-07-10', 'buffet_eventos52@example.com', '2222222222', 'Anúncio de buffet para eventos', 'Serviços', 'Buffet completo para festas', '2000', 32),
    (5, '2023-07-11', 'venda_veiculos53@example.com', '3333333333', 'Anúncio de venda de veículos usados', 'Venda', 'Carros usados em ótimo estado', '15000', 23),
    (3, '2023-07-11', 'festas_infantis54@example.com', '4444444444', 'Anúncio de serviços para festas infantis', 'Serviços', 'Decoração e animação para festas', '500', 14),
    (4, '2023-07-12', 'aluguel_equipamentos55@example.com', '5555555555', 'Anúncio de aluguel de equipamentos', 'Aluguel', 'Equipamentos para construção civil', '300', 25),
    (5, '2023-07-12', 'aulas_musica56@example.com', '6666666666', 'Anúncio de aulas de música', 'Serviços', 'Aulas de piano e violão', '80', 16),
    (4, '2023-07-13', 'venda_eletrodomesticos57@example.com', '7777777777', 'Anúncio de venda de eletrodomésticos', 'Venda', 'Eletrodomésticos novos e usados', '400', 27),
    (3, '2023-07-13', 'servicos_limpeza58@example.com', '8888888888', 'Anúncio de serviços de limpeza', 'Serviços', 'Limpeza residencial e comercial', '100', 38),
    (5, '2023-07-14', 'pet_shop59@example.com', '9999999999', 'Anúncio de pet shop', 'Serviços', 'Produtos e serviços para pets', '50', 39),
    (4, '2023-07-14', 'venda_antiguidades60@example.com', '1010101010', 'Anúncio de venda de antiguidades', 'Venda', 'Objetos antigos e colecionáveis', '500', 40),
     (5, '2023-07-15', 'anuncio_baba61@example.com', '1111111111', 'Anúncio de serviços de babá', 'Serviços', 'Babá experiente e responsável', '30', 1),
    (4, '2023-07-16', 'anuncio_marcineiro62@example.com', '2222222222', 'Anúncio de serviços de marceneiro', 'Serviços', 'Móveis sob medida e reparos', '200', 2),
    (4, '2023-07-17', 'anuncio_lavajato63@example.com', '3333333333', 'Anúncio de lava-jato automotivo', 'Serviços', 'Lavagem completa e polimento', '50', 3),
     (4, '2023-07-18', 'anuncio_baba64@example.com', '4444444444', 'Anúncio de serviços de babá', 'Serviços', 'Cuidado amoroso para crianças', '35', 4),
    (5, '2023-07-19', 'anuncio_baba65@example.com', '5555555555', 'Anúncio de serviços de babá', 'Serviços', 'Babá confiável e flexível', '25', 5),
    (3, '2023-07-20', 'anuncio_baba66@example.com', '6666666666', 'Anúncio de serviços de babá', 'Serviços', 'Cuidado profissional para crianças', '40', 6),
    (4, '2023-07-21', 'anuncio_baba67@example.com', '7777777777', 'Anúncio de serviços de babá', 'Serviços', 'Babá experiente e dedicada', '30', 7),
    (5, '2023-07-22', 'anuncio_baba68@example.com', '8888888888', 'Anúncio de serviços de babá', 'Serviços', 'Cuidado atencioso para crianças', '35', 8),
    (4, '2023-07-23', 'anuncio_lavajato69@example.com', '9999999999', 'Anúncio de lava-jato automotivo', 'Serviços', 'Lavagem e polimento profissional', '40', 9),
    (5, '2023-07-24', 'anuncio_lavajato70@example.com', '1010101010', 'Anúncio de lava-jato automotivo', 'Serviços', 'Cuidado completo para o seu veículo', '60', 10),
    (4, '2023-07-25', 'anuncio_lavajato71@example.com', '1111111111', 'Anúncio de lava-jato automotivo', 'Serviços', 'Limpeza e higienização interna', '50', 11),
    (5, '2023-07-26', 'anuncio_lavajato72@example.com', '2222222222', 'Anúncio de lava-jato automotivo', 'Serviços', 'Polimento e enceramento profissional', '70', 12),
    (3, '2023-07-27', 'anuncio_lavajato73@example.com', '3333333333', 'Anúncio de lava-jato automotivo', 'Serviços', 'Lavagem e aspiração completa', '45', 13);
    
    
    
INSERT INTO comentario (avaliacao, texto, anuncio_id, clientes_id_cliente)
VALUES
    (5, 'Ótimo serviço!', 1, 2),
    (5, 'Recomendo!', 2, 1),
    (4, 'Gostei bastante!', 3, 4),
    (5, 'Atendimento excelente!', 4, 12),
    (5, 'Muito satisfeito!', 5, 30),
    (4, 'Profissional competente!', 6, 39),
    (4, 'Recomendo o serviço!', 7, 10),
    (5, 'Ótimo personal trainer!', 8, 5),
    (5, 'Produto de qualidade!', 9, 14),
    (4, 'Ótimo atendimento!', 10, 22),
    (5, 'Aulas muito proveitosas!', 11, 26),
    (5, 'Excelente equipamento!', 12, 13),
    (4, 'Serviço de qualidade!', 13, 10),
    (5, 'Atendimento rápido e eficiente!', 14, 9),
    (5, 'Roupas lindas!', 15, 32),
    (4, 'Ótimo trabalho de design!', 16, 32),
    (4, 'Serviço de qualidade!', 17, 32),
    (5, 'Profissionalismo exemplar!', 18, 32),
    (5, 'Produtos para pets incríveis!', 19, 17),
    (4, 'Objetos antigos raros!', 20, 18),
    (4, 'Atendimento confiável e seguro!', 1, 8),
    (5, 'Ótimo trabalho de marcenaria!', 2, 35),
    (5, 'Lavação impecável!', 3, 39),
    (4, 'Excelente serviço de babá!', 4, 7),
    (5, 'Serviço de alta qualidade!', 5, 15),
    (4, 'Poderia ser melhor.', 6, 16),
    (5, 'Recomendo fortemente!', 7, 17),
    (3, 'Decepcionante.', 8, 2),
    (4, 'Ótimo atendimento ao cliente!', 9, 6),
    (5, 'Superou minhas expectativas!', 10, 4),
    (4, 'Preço justo pelo serviço.', 11, 12),
    (3, 'Não recomendo.', 12, 18),
    (5, 'Produto incrível!', 13, 19),
    (4, 'Atendimento demorado.', 14, 19),
    (5, 'Profissional muito competente!', 15, 10),
    (4, 'Equipamentos precisam de manutenção.', 16, 11),
    (4, 'Serviço confiável.', 17, 1),
    (5, 'Atendimento ágil e eficaz!', 18, 1),
    (5, 'Peças de alta qualidade!', 19, 5),
    (3, 'Problemas na entrega.', 20, 3),
    (5, 'Ótimo design!', 1, 19),
    (4, 'Poderia ter mais opções de cores.', 2, 21),
    (4, 'Atendimento atencioso.', 3, 20),
    (5, 'Design impressionante!', 4, 26),
    (5, 'Serviço impecável!', 5, 12),
    (4, 'Falta de comunicação.', 6, 10),
    (5, 'Amo os produtos para pets!', 7, 2),
    (3, 'Objetos antigos em más condições.', 8, 1),
    (4, 'Atendimento seguro e confiável.', 9, 28),
    (5, 'Ótimos trabalhos de marcenaria!', 10, 24),
    (5, 'Carro limpo e brilhante!', 11, 22),
    (3, 'Danificaram meu veículo.', 12, 20),
    (5, 'Excelente babá!', 13, 33),
    (4, 'Cuidado insuficiente com as crianças.', 14, 35),
    (4, 'Atendimento profissional.', 15, 32),
    (5, 'Lavagem perfeita!', 16, 30);
    
    
    -- UPDATES E DELETES
    
    delete  from comentario where id = 55;
    
    update clientes set telefone = '000000000' where id_cliente = 2;
    
    update clientes set email = 'foi.alterado@email.com' where id_cliente = 20;
    
    update empresa set telefone = '9999999999' where id = 17;
    
    update empresa set email = 'empresa.alterao@empresa.com' where id = 12;
    
    update anuncio set email = 'anuncio.alterado@anuncioo.com' where id = 12;
    
    
     update anuncio set data_postagem = now() where id = 12;
     
     update anuncio set valor = 12000 where id = 32;
     
     update comentario set texto = 'Foi alterado aqui' where id = 32;
     
     update comentario set avaliacao = 0 where id = 32;
     
     -- views
     
    CREATE VIEW view_empresas_quantidade_anuncios AS
SELECT empresa.razao_social, anuncio.tipo, COUNT(anuncio.id) AS total_anuncios
FROM empresa
LEFT JOIN anuncio ON empresa.id = anuncio.empresa_id
GROUP BY empresa.id, anuncio.tipo;


CREATE VIEW view_anuncio_menor_valor AS
SELECT *
FROM anuncio
WHERE valor = (
    SELECT MIN(valor)
    FROM anuncio
);

CREATE VIEW view_anuncios_junho_2023 AS
SELECT *
FROM anuncio
WHERE MONTH(data_postagem) = 6 AND YEAR(data_postagem) = 2023;

CREATE VIEW view_clientes_sem_comentarios AS
SELECT clientes.*
FROM clientes
LEFT JOIN comentario ON clientes.id_cliente = comentario.clientes_id_cliente
WHERE comentario.id IS NULL;
    
    
CREATE VIEW view_empresas_anuncios AS
SELECT empresa.razao_social, anuncio.tipo, COUNT(anuncio.id) AS total_anuncios
FROM empresa
LEFT JOIN anuncio ON empresa.id = anuncio.empresa_id

GROUP BY empresa.id, anuncio.tipo;

CREATE VIEW view_anuncios_avaliacao AS
SELECT anuncio.*, AVG(comentario.avaliacao) AS media_avaliacao, COUNT(comentario.id) AS total_comentarios
FROM anuncio
LEFT JOIN comentario ON anuncio.id = comentario.anuncio_id
GROUP BY anuncio.id;

CREATE VIEW view_clientes_comentarios AS
SELECT clientes.nome, COUNT(DISTINCT comentario.anuncio_id) AS total_anuncios_comentados
FROM clientes
LEFT JOIN comentario ON clientes.id_cliente = comentario.clientes_id_cliente
GROUP BY clientes.id_cliente;


CREATE VIEW view_anuncios_recentes_tipo AS
SELECT a.*
FROM anuncio AS a
LEFT JOIN anuncio AS a2 ON a.tipo = a2.tipo AND a.data_postagem < a2.data_postagem
WHERE a2.id IS NULL;


CREATE VIEW view_clientes_comentarios_avaliacao_alta AS
SELECT c.nome, c.email, a.avaliacao
FROM clientes AS c
INNER JOIN comentario AS co ON c.id_cliente = co.clientes_id_cliente
INNER JOIN anuncio AS a ON co.anuncio_id = a.id
WHERE a.avaliacao > 4;


CREATE VIEW view_clientes_mais_comentarios AS
SELECT clientes.nome, COUNT(comentario.id) AS total_comentarios
FROM clientes
INNER JOIN comentario ON clientes.id_cliente = comentario.clientes_id_cliente
GROUP BY clientes.id_cliente
ORDER BY total_comentarios DESC;


    
    
 